{% extends "main/main.html" %}
{% load selections %}
{% load humanize %}
{% load tz %}
{% load static %}
{% block page_title %}
    Main page Trianglesis's
{% endblock %}
{% block content %}
    {# <img src="/static/favicon/android-chrome-192x192.png" style="height: 50%; width: 50%" class="card-img-top" alt="...">#}
    {% comment %}
     <div class="alert alert-dark" role="alert">
        A simple dark alertâ€”check it out!
    </div>
{% endcomment %}
    <div class="main-body">
        {% if error_message %}
            <div class="under-construction">
                <div class="alert alert-warning" role="alert">
                    <span><a class="txt-bold text-danger nodecor" href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Status">{{ error_code }}</a></span>
                    <span>{{ error_message }}</span>
                </div>
            </div>
        {% endif %}

        <div class="under-construction">
            <div class="alert alert-info" role="alert">
                Last 4 posts published.
            </div>
        </div>
        {% comment %} Last 3 posts {% endcomment %}
        <div class="last-posts">
            <div class="row row-cols-1 row-cols-md-2 g-4">
                {% posts_last 4 as last_posts %}
                {% for post in last_posts %}
                    <div class="col">
                        <div class="card h-100">
                            <div class="card-header">
                                <h5>{{ post.title }}</h5>
                            </div>
                            <div class="card-body">
                                <p class="card-text">
                                    {{ post.body|safe|truncatewords_html:30 }}
                                </p>
                                <div>
                                    <p><a href="{% url 'post' post.slug %}" class="btn btn-sm btn-outline-info">
                                        {% if post.meta_description %}{{ post.meta_description }}{% else %}Read...{% endif %}</a></p>
                                </div>
                            </div>
                            <div class="card-footer text-muted d-flex justify-content-between">
                                <div class="text-right">
                                    <span class="badge bg-dark">{{ post.author.first_name }}</span>
                                    <span title="raw time: {{ post.publish_date }}"
                                          class="badge bg-light text-dark">{{ post.publish_date|timezone:"Europe/Kyiv"|date:'Y N d (D) H:i'|naturaltime }}</span>
                                    {% if post.tags.all %}
                                        {% for tag in post.tags.all %}
                                            <a title="{{ tag.description }}" href="{% url 'blog' %}?tag={{ tag.name }}"><span class="badge bg-secondary">{{ tag.name }}</span></a>
                                        {% endfor %}
                                    {% endif %}
                                </div>
                                <div class="text-left">
                                    {% if post.hits_rel_post %}
                                        <span class="badge bg-secondary"
                                              title="Hits or unique visitors">{{ post.hits_rel_post.hits }}</span>
                                        <span class="disqus-comment-count"
                                              data-disqus-url="{{ post.get_absolute_hostname_url }}"
                                              data-disqus-identifier="{{ post.slug }}"></span>
                                    {% endif %}
                                </div>
                            </div>
                        </div>
                    </div>
                {% endfor %}
            </div>
        </div>
        <div class="under-construction">
            <div class="alert alert-warning" role="alert">
                Under construction, see <a href="{% url 'blog' %}" class="alert-link">blog</a>. Random 10 posts below.
            </div>
        </div>
        <div class="random-posts">
            <div class="row row-cols-1 row-cols-md-3 g-2">
                {% posts_random 10 as rand_posts %}
                {% for post in rand_posts %}
                    <div class="col">
                        <div class="card h-100">
                            <div class="card-body">
                                <h6 class="card-text">{{ post.title }}</h6>
                                <p class="card-text">{{ post.body|safe|truncatechars_html:100 }}</p>
                                <p><a href="{% url 'post' post.slug %}" class="btn btn-sm btn-outline-info">
                                    {% if post.meta_description %}{{ post.meta_description }}{% else %}Read...{% endif %}</a></p>
                            </div>
                            <div class="card-footer text-muted d-flex justify-content-between">
                                <div class="text-right">
                                    <span class="badge bg-dark">{{ post.author.first_name }}</span>
                                    <span title="raw time: {{ post.publish_date }}"
                                          class="badge bg-light text-dark">{{ post.publish_date|timezone:"Europe/Kyiv"|date:'Y N d (D) H:i'|naturaltime }}</span>
                                    {% if post.tags.all %}
                                        {% for tag in post.tags.all %}
                                            <a title="{{ tag.description }}" href="{% url 'blog' %}?tag={{ tag.name }}"><span class="badge bg-secondary">{{ tag.name }}</span></a>
                                        {% endfor %}
                                    {% endif %}
                                </div>
                                <div class="text-left">
                                    {% if post.hits_rel_post %}
                                        <span class="badge bg-secondary"
                                              title="Hits or unique visitors">{{ post.hits_rel_post.hits }}</span>
                                        <span class="disqus-comment-count"
                                                {% comment %}data-disqus-url="{{ post.get_absolute_hostname_url }}"{% endcomment %}
                                              data-disqus-identifier="{{ post.slug }}"></span>
                                    {% endif %}
                                </div>
                            </div>
                        </div>
                    </div>
                {% endfor %}
            </div>
        </div>
    </div>
{% endblock %}
